jQuery(document).ready(function(e){e('button[name="st_force_data_fetch_stop"]').on("click",function(t){t.preventDefault(),e(this).data("stop","true")}),e('button[name="st_force_data_fetch"]').on("click",function(t){t.preventDefault();var a=this,s=e('button[name="st_force_data_fetch_stop"]');e(a).prop("disabled",!0),e(s).addClass("enabled"),e.ajax({type:"post",dataType:"json",async:!0,url:stockTickerJs.ajax_url,data:{action:"stockticker_purge_cache"}}).done(function(t){function o(){e.ajax({type:"post",dataType:"json",async:!0,url:stockTickerJs.ajax_url,data:{action:"stockticker_update_quotes"}}).done(function(t){if(t.done||"true"==e(s).data("stop"))"DONE"!=t.message?e(".st_force_data_fetch").append("<br />["+t.symbol+"] "+t.message):e(".st_force_data_fetch").append("<br />DONE"),e(a).prop("disabled",!1),e(s).removeClass("enabled").data("stop","false");else{if(t.message.indexOf("Operation timed out")>=0)e(".st_force_data_fetch").append("[Timeout] "+t.symbol+"<br />");else if(t.message.indexOf("Invalid API call")>=0){var c=stockTickerJs.avurl;"intraday"==t.method&&(c=stockTickerJs.avurli),e(".st_force_data_fetch").append("[Invalid API call] "+t.symbol+' (<a href="'+c+t.symbol+'" target="_blank">test</a>)<br />')}else e(".st_force_data_fetch").append("[OK] "+t.symbol+"<br />");setTimeout(function(){o()},2e3)}}).fail(function(t){e(".st_force_data_fetch").append("<br />[Error] "+t.message)})}e(".st_force_data_fetch").html("Reset fetching loop and fetch data again. Please wait...<br /><br />"),o()})})});