jQuery(document).ready(function(t){var e=function(){var e=t('input[name="stockticker_defaults[all_symbols]"]').val().toString().split(",").length*t('input[name="stockticker_defaults[timeout]"]').val()*1.5;t("#fetch_timeout_advisor .min").html(Math.ceil(e))};t('input[name="stockticker_defaults[cache_timeout]"]').after('&nbsp;<span id="fetch_timeout_advisor">at least <span class="min"></span></span>'),e(),t('input[name="stockticker_defaults[timeout]"], input[name="stockticker_defaults[all_symbols]"]').on("change click keydown",function(t){e()}),t('button[name="st_force_data_fetch_stop"]').on("click",function(e){e.preventDefault(),t(this).data("stop","true")}),t('button[name="st_force_data_fetch"]').on("click",function(e){e.preventDefault();var a=this,s=t('button[name="st_force_data_fetch_stop"]'),o=60/t('select[name="stockticker_defaults[av_api_tier]"]').val()*1e3;t(a).prop("disabled",!0),t(s).addClass("enabled"),t.ajax({type:"post",dataType:"json",async:!0,url:stockTickerJs.ajax_url,data:{action:"stockticker_purge_cache"}}).done(function(e){function c(){t.ajax({type:"post",dataType:"json",async:!0,url:stockTickerJs.ajax_url,data:{action:"stockticker_update_quotes"}}).done(function(e){if(e.done||"true"==t(s).data("stop"))"DONE"!=e.message?t(".st_force_data_fetch").append("<br />["+e.symbol+"] "+e.message):t(".st_force_data_fetch").append("<br />DONE"),t(a).prop("disabled",!1),t(s).removeClass("enabled").data("stop","false");else{stockTickerJs.avurl;"wait"==e.method?t(".st_force_data_fetch").append("[WAIT] "+e.message+"<br />"):e.message.indexOf("Operation timed out")>=0?t(".st_force_data_fetch").append("[Timeout] "+e.symbol+"<br />"):e.message.indexOf("Invalid API call")>=0?t(".st_force_data_fetch").append("[Invalid API call] "+e.symbol+' (<a href="'+stockTickerJs.avurl+e.symbol+'" target="_blank">test</a>)<br />'):e.message.indexOf("Bad API response")>=0?t(".st_force_data_fetch").append("[Bad API response] "+e.symbol+' (<a href="'+stockTickerJs.avurl+e.symbol+'" target="_blank">test</a> OR try to prefix stock symbol with stock exchange)<br />'):t(".st_force_data_fetch").append("[OK] "+e.symbol+"<br />"),setTimeout(function(){c()},o)}}).fail(function(e){t(".st_force_data_fetch").append("<br />[Error] "+e.message)})}t(".st_force_data_fetch").html("Reset fetching loop and fetch data again. We`ll make pause "+o/1e3+" second(s) between each symbol fetch. Please wait...<br /><br />"),c()})})});